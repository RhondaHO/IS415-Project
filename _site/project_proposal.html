<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nguyen Mai Phuong">
<meta name="author" content="Kwan Kai Xuan Belle">
<meta name="author" content="Rhonda Ho Kah Yee">

<title>G1T7 Project Proposal</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="The Right Place" class="navbar-brand navbar-brand-logo">
    <img src="./logo.png" alt="" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text">About Us</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./project_proposal.html" aria-current="page">
 <span class="menu-text">Project Proposal</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/G1T777/IS415-Project"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">G1T7 Project Proposal</h1>
            <p class="subtitle lead">Analyzing Spatial Point Patterns of HDB Locations and Amenities: Insights for Urban Planning and Resource Allocation</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Authors</div>
      <div class="quarto-title-meta-contents">
               <p>Nguyen Mai Phuong </p>
               <p>Kwan Kai Xuan Belle </p>
               <p>Rhonda Ho Kah Yee </p>
            </div>
    </div>
      
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">March 29, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#project-motivation" id="toc-project-motivation" class="nav-link active" data-scroll-target="#project-motivation">Project Motivation</a></li>
  <li><a href="#project-objectives" id="toc-project-objectives" class="nav-link" data-scroll-target="#project-objectives">Project Objectives</a></li>
  <li><a href="#data-sets" id="toc-data-sets" class="nav-link" data-scroll-target="#data-sets">Data Sets</a></li>
  <li><a href="#literature-review" id="toc-literature-review" class="nav-link" data-scroll-target="#literature-review">Literature Review</a></li>
  <li><a href="#our-approach" id="toc-our-approach" class="nav-link" data-scroll-target="#our-approach">Our Approach</a></li>
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#application-system-architecture" id="toc-application-system-architecture" class="nav-link" data-scroll-target="#application-system-architecture">Application System Architecture</a></li>
  <li><a href="#timeline" id="toc-timeline" class="nav-link" data-scroll-target="#timeline">Timeline</a></li>
  <li><a href="#early-storyboard-drafts" id="toc-early-storyboard-drafts" class="nav-link" data-scroll-target="#early-storyboard-drafts">Early Storyboard Drafts</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="project-motivation" class="level2">
<h2 class="anchored" data-anchor-id="project-motivation">Project Motivation</h2>
<p>Many prospective HDB buyers struggle to visualize and understand the amenities and facilities available in the vicinity of their desired location, often having to resort to manual searches on platforms like Google to determine the location of specific types of amenities. Additionally, current mapping tools do not provide a comprehensive and tailored view of amenities specific to HDBs. Our motivation is to simplify this process and make it easier for HDB buyers to view and understand the surrounding amenities through our analytical app. By providing a customized view of amenities relevant to HDB buyers, utilizing spatial point pattern analysis to visualize their distribution and clustering, and offering a user-friendly interface, we aim to help HDB buyers make more informed decisions about their purchases and feel more confident in their chosen residence.</p>
</section>
<section id="project-objectives" class="level2">
<h2 class="anchored" data-anchor-id="project-objectives">Project Objectives</h2>
<p>This study seeks to gather crucial data that one might need to analyse and visualise to perform spatial point pattern analysis to:</p>
<ol type="1">
<li><p>Estimate the intensity of HDB locations and amenities across the study area using Kernel Density Estimation.</p></li>
<li><p>Determine whether the distribution of amenities around HDBs is random or clustered, and calculate the ratio of observed to expected nearest neighbor distances using F-Function analysis.</p></li>
<li><p>Measure the degree of clustering or dispersion of HDB locations and surrounding amenities using Ripley’s K-function and L-function analysis.</p></li>
<li><p>Quantify the extent of spatial association and heterogeneity between HDB locations and surrounding amenities using Colocation Quotients (CLQs) analysis.</p></li>
<li><p>Conduct Network Constrained Spatial Point Patterns Analysis to analyze the spatial distribution of HDB flats over a street network.</p></li>
</ol>
<p>By achieving these objectives, our study aims to gain insights into the spatial distribution of HDB and amenities across the study area, identify significant spatial patterns and trends, and help inform planning and policy decisions related to urban development and resource allocation.</p>
</section>
<section id="data-sets" class="level2">
<h2 class="anchored" data-anchor-id="data-sets">Data Sets</h2>
<p>Below is a table of the data sets we will be using for our project.</p>
<table class="table">
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
<th>File Format</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>HDB Resale Flat Prices</td>
<td>Provides HDB addresses, blocks and street name | <a href="https://data.gov.sg/dataset/resale-flat-prices">Data.gov.sg</a></td>
<td>.csv</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>School Directory and Information</td>
<td>Provides a list of primary schools in Singapore | <a href="https://data.gov.sg/dataset/school-directory-and-information">Data.gov.sg</a></td>
<td>.csv</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Shopping Malls</td>
<td>Provides a list of shopping mall and its geometry in Singapore | Web scrapped shopping mall data in 2019 by <a href="https://github.com/ValaryLim/Mall-Coordinates-Web-Scraper">Valery Lim</a></td>
<td>.csv</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>URA Master Plan 2019 Subzone Boundary</td>
<td>Provides region boundary data | Referenced/taken from Prof Kam</td>
<td>shp</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Bus Stops</td>
<td>Provides a list of bus stops and its geometry in Singapore | <a href="https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=bus%20stop">Datamall LTA</a></td>
<td>.shp</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Train Station</td>
<td>Provides a list of MRT/LTR exits and its geometry in Singapore | <a href="https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=Train">Datamall LTA</a></td>
<td>.shp</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Supermarkets</td>
<td>Provides a list of supermarkets in Singapore | <a href="https://data.gov.sg/dataset/supermarkets">Data.gov.sg</a></td>
<td>.geojson</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Childcare Centres</td>
<td>Provides a list of names, addresses and relevant information for childcare centres in Singapore | Extracted via onemapAPI <a href="https://www.onemap.gov.sg/docs/">API Docs</a> | <a href="https://www.onemap.gov.sg/docs/#register-free-account">Registration</a></td>
<td>.rds</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Eldercare Centres</td>
<td>Provides a list of names, addresses and relevant information for eldercare centres in Singapore | Extracted via onemapAPI</td>
<td>.rds</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Kindergartens</td>
<td>Provides a list of names, addresses and relevant information for kindergartens in Singapore | Extracted via onemapAPI</td>
<td>.rds</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Hawker Centres</td>
<td>Provides a list of names, addresses and relevant information for hawker centres in Singapore | Extracted via onemapAPI</td>
<td>.rds</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Healthier Hawker Centres</td>
<td>Provides a list of names, addresses and relevant information for healthier hawker centres in Singapore | Extracted via onemapAPI</td>
<td>.rds</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>National Parks</td>
<td>Provides a list of names, addresses and relevant information for national parks in Singapore | Extracted via onemapAPI</td>
<td>.rds</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Gyms</td>
<td>Provides a list of names, addresses and relevant information for gyms in Singapore | Extracted via onemapAPI</td>
<td>.rds</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Retail Pharmacies</td>
<td>Provides a list of names, addresses and relevant information for retail pharmacies in Singapore | Extracted via onemapAPI</td>
<td>.rds</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Singapore Police Force (SPF) Establishments</td>
<td>Provides a list of names, addresses and relevant information for SPF establishments in Singapore | Extracted via onemapAPI</td>
<td>.rds</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Carparks</td>
<td>Provides a list of names, addresses and relevant information for carparks in Singapore | Extracted via onemapAPI</td>
<td>.rds</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="literature-review" class="level2">
<h2 class="anchored" data-anchor-id="literature-review">Literature Review</h2>
<section id="spatial-point-pattern-analysis-of-human-settlements-and-geographical-associations-in-eastern-coastal-china---a-case-study-zhang-et-al.-2014" class="level4 review">
<h4 class="review anchored" data-anchor-id="spatial-point-pattern-analysis-of-human-settlements-and-geographical-associations-in-eastern-coastal-china---a-case-study-zhang-et-al.-2014">#1: Spatial Point Pattern Analysis of Human Settlements and Geographical Associations in Eastern Coastal China - A Case Study <a href="https://www.mdpi.com/1660-4601/11/3/2818">(Zhang et al., 2014)</a></h4>
<p>This article highlights the potential of spatial point pattern analysis as a tool for gaining insights into the spatial patterns and associations of human settlements in rapidly urbanising regions. The article used spatial point pattern analysis techniques such as Ripley’s K-function and nearest neighbour analysis, to analyse the spatial distribution and clustering of human settlements in eastern coastal China. Based on their results, it demonstrates the importance of considering spatial relationships and locational factors in understanding settlement patterns and provides insights that can be used to inform urban planning and development policies.</p>
<section id="how-does-it-link-to-our-project" class="level5">
<h5 class="anchored" data-anchor-id="how-does-it-link-to-our-project">How does it link to our project?</h5>
<p>To examine the spatial distribution and clustering of HDB locations and facilities in Singapore. We plan to use the following functions referenced from the article:</p>
<ol type="1">
<li><p>Kernel density estimation: To identify areas with high or low concentrations of HDB locations or facilities, and to explore the relationship between HDB locations and surrounding amenities.</p></li>
<li><p>Ripley’s K-function: To measure the degree of spatial clustering or dispersion of point locations, which can help identify hotspots or coldspots of HDB locations or facilities and compare the observed spatial distribution of HDB locations or facilities to a random distribution, and test whether the observed pattern is statistically significant.</p></li>
</ol>
</section>
</section>
<section id="analysing-the-global-and-local-spatial-associations-of-medical-resources-across-wuhan-city-using-poi-data-chen-q-et-al.-2023" class="level4">
<h4 class="anchored" data-anchor-id="analysing-the-global-and-local-spatial-associations-of-medical-resources-across-wuhan-city-using-poi-data-chen-q-et-al.-2023">#2: Analysing the global and local spatial associations of medical resources across Wuhan city using POI data <a href="https://link.springer.com/article/10.1186/s12913-023-09051-0">(Chen, Q et al., 2023)</a></h4>
<p>This article highlights the issue of imbalance in the supply and demand of medical resources in provincial capitals of China and emphasises the need to understand the spatial patterns of medical resources to ensure fair and optimal allocation of limited resources. This article utilises the Localised Colocation Quotient (LCLQ) analysis, which is a technique that measures directional spatial associations and heterogeneity between categorical point data. By employing this method and utilising point of interest (POI) data, the study presents a unique analysis of the spatial patterns and directional spatial associations between six medical resources in Wuhan city.</p>
<section id="how-does-it-link-to-our-project-1" class="level5">
<h5 class="anchored" data-anchor-id="how-does-it-link-to-our-project-1">How does it link to our project?</h5>
<p>For our project, we need to first define the two types of features of interest which will be HDB locations and the presence of certain amenities. Some examples are schools, carparks, shopping centres and MRT stations. By comparing the observed and expected frequencies of co-occurrence using the LCLQ, we can determine whether HDB locations and surrounding amenities are spatially associated in a non-random way. This can provide insights into the degree to which the availability of amenities in an area affects HDB locations, and vice versa.</p>
</section>
</section>
</section>
<section id="our-approach" class="level2">
<h2 class="anchored" data-anchor-id="our-approach">Our Approach</h2>
<ol type="1">
<li><p>Data Preparation</p>
<ul>
<li><p>Assemble data from various sources</p></li>
<li><p>Data handling and wrangling</p></li>
</ul></li>
<li><p>Exploratory Data Analysis</p>
<ul>
<li><p>Analyse the spatial arrangement of data points</p></li>
<li><p>Identify any outliers or anomalies in the data sets</p></li>
<li><p>Choropleth Mapping</p></li>
</ul></li>
<li><p>Spatial Point Patterns Analysis (Filter by: Sub-district/Region)</p>
<ol type="1">
<li><p>First point Analysis</p>
<ol type="1">
<li>Kernel Density Estimation:</li>
</ol></li>
<li><p>Second point Analysis</p>
<ol type="1">
<li><p>F-Function: Identify whether the distribution of amenities around HDBs is random or clustered, and the ratio of observed to expected nearest neighbor distances.</p></li>
<li><p>Ripley’s K-function and L function: To measure the degree of clustering or dispersion of HDB locations and surrounding amenities, and help identify significant spatial patterns and trends.</p></li>
<li><p>Colocation Quotients CLQs: To measure the extent of spatial association and heterogeneity between HDB locations and surrounding amenities, helping to identify areas of high or low co-location.</p></li>
<li><p>Network Constrained Spatial Point Patterns Analysis: To analyse the spatial distribution of HDB flats over a street network</p></li>
</ol></li>
</ol></li>
</ol>
</section>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<p>Below is the list of packages we will be using for our project:</p>
<ul>
<li><p><strong>sf</strong>: import and handle geospatial data</p></li>
<li><p><strong>tidyverse</strong>: data wrangling (tidyr, dplyr, ggplot2, tibble)</p></li>
<li><p><strong>tmap</strong>: plot choropleth maps</p></li>
<li><p><strong>maptools</strong>: a set of tools for manipulating geographic data</p></li>
<li><p><strong>raster</strong>: convert grid output to raster layer for visualisation (Kernel Density Estimation)</p></li>
<li><p><strong>spatstat</strong>: conversion from spatial object to ppp format (Spatial Point Pattern plot)</p></li>
<li><p><strong>funModeling</strong>: plotting EDA</p></li>
</ul>
</section>
<section id="application-system-architecture" class="level2">
<h2 class="anchored" data-anchor-id="application-system-architecture">Application System Architecture</h2>
<p><img src="img/architecture.PNG" class="img-fluid" width="699"></p>
</section>
<section id="timeline" class="level2">
<h2 class="anchored" data-anchor-id="timeline">Timeline</h2>
<p><img src="img/timeline.PNG" class="img-fluid" width="735"></p>
</section>
<section id="early-storyboard-drafts" class="level2">
<h2 class="anchored" data-anchor-id="early-storyboard-drafts">Early Storyboard Drafts</h2>
<p>We used Figma to create a draft designs of our storyboard on how we imagine our Shiny app to look like. Please click <a href="https://www.figma.com/file/xSVmDxxrKS9le1u5vu5TVg/GAA-Wireframe?node-id=0%3A1&amp;t=3MQUviIz5JP2tEkD-1">here</a> to view it in Figma.</p>
<p><img src="img/storyboard1.PNG" class="img-fluid" width="658"> <img src="img/storyboard2.PNG" class="img-fluid" width="658"> <img src="img/storyboard3.PNG" class="img-fluid" width="658"> <img src="img/storyboard4.PNG" class="img-fluid" width="658"> <img src="img/storyboard5.PNG" class="img-fluid" width="658"></p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>Literature review #1: <a href="https://www.mdpi.com/1660-4601/11/3/2818" class="uri">https://www.mdpi.com/1660-4601/11/3/2818</a></p>
<p>Literature review #2: <a href="https://link.springer.com/article/10.1186/s12913-023-09051-0" class="uri">https://link.springer.com/article/10.1186/s12913-023-09051-0</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>